Piscis
======

``piscis`` is an automatic deep learning algorithm for spot detection, written in Python using the 
`JAX <https://github.com/google/jax>`_ and `Flax <https://github.com/google/flax>`_ libraries. It is named after the Latin 
word for fish, as it was designed specifically for microscopy images generated by RNA fluorescence *in situ* 
hybridization (FISH). However, we have found it to be useful for other imaging methods, such as immunofluorescence (IF) 
and FISH-based spatial transcriptomics. To learn more about ``piscis``, please read our 
`preprint <https://doi.org/10.1101/2024.01.31.578123>`_.

This Python package allows users to apply pre-trained models from `Hugging Face <https://huggingface.co/wniu/Piscis>`_ to 
both single plane images and z-stacks or to train new models using custom datasets. It provides a simple API for both 
training and inference that can be used in traditional Python scripts or `Jupyter <https://jupyter.org/>`_ notebook 
environments such as on `Google Colab <https://colab.research.google.com/>`_. It also provides a command line interface 
for those who prefer the terminal. For a user-friendly graphical user interface, we have implemented ``piscis`` as a 
`Docker image <https://github.com/arjunrajlaboratory/ImageAnalysisProject/tree/master/workers/annotations/piscis>`_ for 
`NimbusImage <https://github.com/Kitware/UPennContrast>`_, a cloud platform for biological image analysis enabling 
researchers to interactively visualize their data while leveraging state-of-the-art machine learning algorithms.

Examples
--------

.. image:: /_static/examples.png
   :alt: Examples

Citation
--------

If you use ``piscis`` in your research, please cite our `preprint <https://doi.org/10.1101/2024.01.31.578123>`_.

   Niu, Z., O’Farrell, A., Li, J., Reffsin, S., Jain, N., Dardani, I., Goyal, Y., & Raj, A. (2024). Piscis: A novel loss 
   estimator of the F1 score enables accurate spot detection in fluorescence microscopy images via deep learning. 
   *bioRxiv*. https://doi.org/10.1101/2024.01.31.578123

.. code-block:: bibtex

   @article{Niu2024-Piscis,
       title={Piscis: A novel loss estimator of the F1 score enables accurate spot detection in fluorescence microscopy images via deep learning},
       author={Niu, Zijian and O’Farrell, Aoife and Li, Jingxin and Reffsin, Sam and Jain, Naveen and Dardani, Ian and Goyal, Yogesh and Raj, Arjun},
       year=2024,
       journal="bioRxiv",
       DOI={10.1101/2024.01.31.578123}
   }

License
-------

``piscis`` is licensed under the MIT License. The copyright and permission notices found in the 
`LICENSE <https://raw.githubusercontent.com/zjniu/piscis/main/LICENSE>`_ file shall be included in all copies or substantial portions of the Software.

.. toctree::
   :hidden:

   getting_started
   installation
   inference
   training
   cli
